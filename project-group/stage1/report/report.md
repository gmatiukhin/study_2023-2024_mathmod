---
## Front matter
title: "Моделирование образования планетной системы"
subtitle: "Этап 1"
author: "Матюхин Г. В. и Генералов Д. М."

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Теоретическое описание задачи

Газопылевое облако, из которого позднее образовались планеты и Солнце нашей Солнечной системы, имело ненулевой момент импульса, то есть вращалось. Известно, что суммарный момент импульса в замкнутой системе сохраняется. По мере гравитационного сжатия газопылевого облака расстояние всех его частей от оси вращения сокращалось и скорость вращения сгущающегося облака увеличивалась. Очевидно, что в плоскости, перпендикулярной оси вращения, сжатие происходило медленнее. Поэтому облако, бывшее изначально шаровидным, становилось все более плоским. Из-за гравитационной неустойчивости на периферии формирующегося диска отделилось кольцо вещества. Оставшееся облако продолжало сжиматься и вращаться еще быстрее. Затем от него отделилось новое кольцо вещества. Позднее кольца вещества сгустились в планеты.

# Цель работы

Провести моделирование одного из этапов эволюции Вселенной -- образование некой "солнечной" системы из межзвездного газа.

# Описание модели

## Изначальное состояние

Так как число моделируемых частиц весьма ограничено, то можно сказать, что в этой модели планеты образуются из уже сформировавшихся газопылевых уплотнений, которыми и являются задаваемые частицы[@modeling_textbook].

Распределение частиц в плоскости в начальный момент времени задается случайным образом, при достаточно большом количестве частиц распределение будет равномерным, если для двумерного случая модуль радиус-вектора выбирать как $r = r_0\sqrt{random}$. Здесь $r_0$ -- радиус газопылевого диска. Случайное значение азимутального угла вычисляется по формуле $\alpha = 2\pi \times random$. Для нахождения начальной скорости, используя третий закон Кеплера, получаем, что $v_x = -y\omega_0\left(\frac{r_0}{r}\right)^\frac{3}{2}, v_y = x\omega_0\left(\frac{r_0}{r}\right)^\frac{3}{2}, v_z = 0$, где $\omega_0$ -- угловая скорость частиц на расстоянии $r_0$ от оси диска.

## Потенциальная энергия системы

Потенциальная энергия гравитационного взаимодействия одной частицы со всеми остальными описывается формулой:

$$U_i = - \sum\frac{\gamma m_jm_i}{r_{ij}}$$

Полная потенциальная энергия системы частиц равна

$$U = \frac{1}{2}\sum_iU_i$$

Множитель 1/2 нужен, так как энергия взаимодействия между каждой
парой частиц учитывается в этой сумме дважды.

## Столкновения

Для частиц, у которых расстояние между центрами меньше суммы их радиусов, необходимо ввести силы трения и отталкивания. Это делается для удобства написания программы, так как в реальности при столкновении двух газопылевых облаков произойдет их слипание, в облаках возникнут ударные волны, и при слишком больших скоростях возможно их разбиение на более мелкие.

Силу отталкивания можно взять в виде

$$F^r(b)=k\left(\left(\frac{a}{b}\right)^8 - 1\right),$$

где $a=R_i + R_j$ сумма радиусов частиц $i$ и $j$, $b$ -- модуль радиус-вектора взаимодействия $b = r_{i,j} = r_i − r_j$. Для того, чтобы сила быстро нарастала при уменьшении расстояния между частицами, взята восьмая степень. При $b = a$ сила отталкивания обращается в ноль. При сближении частиц на расстояние меньше суммы их радиусов возникает энергия отталкивания, она равна

$$E = -\int^rF^r(x)dx$$

Сила трения перпендикулярна радиус-вектору взаимодействия $b$ и направлена против движения частиц относительно друг друга. Единичный вектор вдоль силы трения для двумерной модели равен

$$n = (n_x,n_y) = \frac{(-b_y,b_x)}{\sqrt{b_x^2 + b_y^2}}$$

Относительная скорость поверхностей частиц, перпендикулярная радиусу, $W_{\bot} = W \times n − \omega_iR_i − \omega_jR_j$ , где $\omega_i$ и $\omega_j$ -- угловые скорости вращения частиц $i$ и $j$, $W = v_i − v_j$ -- относительная скорость двух взаимодействующих частиц.

Сила трения по модулю равна $F^f=\mu F^r(b)$, где $\mu$ -- коэффициент трения, зависящий от скорости $W_\bot$. В простейшем приближении $\mu = \beta W_\bot$. Тогда вектор силы трения равен

$$F^f=\beta W_\bot F^r(b)n$$

Угловую скорость каждой частицы можно найти с помощью системы уравнений:

$$
\begin{cases}
    I_i\varepsilon_i=R_i\sum F_{i,j}^f\frac{b}{R_i + R_j},\\
    \frac{d\omega_i}{dt} = \varepsilon_i,
\end{cases}
$$

где $I_i=\frac{2}{5}m_iR_i^2$ -- момент инерции, $\varepsilon_i$ -- угловое ускорение. Энергия вращения равна $E_{rot} = I_i\frac{\omega^2}{2}$.

Единичный вектор вдоль силы трения для трехмерной модели равен

$$n = \frac{z}{|z|},$$

где $z = \left[\left[b \times W\right] \times b\right] = W(b \times b) - b(b \times W)$.

Для системы, в которой есть сила трения, полная энергия не сохраняется, часть энергии в результате трения переходит в тепло. Энергию, перешедшую в тепло, можно найти в виде разности начальной и текущей полной энергии.

## Слипание

Возможно полное слипание пары частиц. В результате образуется одна, радиус которой вычисляется как

$$R = \sqrt[3]{R_i^3 + R_j^3},$$

а масса равна сумме масс слипшихся облаков. Координаты новой частицы вычисляются по формуле

$$r = \frac{m_ir_i + m_jr_j}{m_i+m_j}$$

Аналогично вычисляется скорость

$$v = \frac{m_iv_i + m_jv_j}{m_i + m_j}$$

Надо иметь ввиду, что при слипании частиц гравитационная энергия результирующей частицы не равна сумме гравитационных энергий исходных частиц

$$(E_g)_i= -\frac{\gamma m_i^2}{2R_i}$$

# Вывод

На данном этапе выполнения проекта мы рассмотрели как образование пленетных систем происходит в реальном мире. На основании этого мы создали математическую модель, учитывающую поведение "частиц" газопылевых уплотнений и сил воздействующих на них. Нами также были приняты некоторые допущения, позволяющие сделать модель производительнее.

# Список литературы{.unnumbered}

::: {#refs}
:::
